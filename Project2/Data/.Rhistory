results <- read.csv("http://jonsmitchell.com/data/biol112labresults.csv", stringsAsFactors=F)
model.data <- data.frame("Number.Eggs" = data$Number.of.mature.eggs, "N.family.level" = data$N.family.level, "spec.id" = data$spec.id, "binom" = data$binom, "Wing.Length" = data$Wing.length, "Timing" = data$Timing, "Family" = data$Family, "Species" = data$Species)
treeb <- read.nexus("butterfly_tree.nex")
treeb <- read.nexus("butterfly_tree.nex")
library(phytools)
treeb <- read.nexus("butterfly_tree.nex")
setwd("~/Desktop/Evolution/Tasks/Project2/Data")
read.csv("individual_collection_data.csv"
)
dir()
treeb <- read.nexus("butterfly_tree.nex")
treeb
plot(treeb)
head(model.data)
data1 <- read.csv("individual_collection_data.csv")
data2 <- read.csv("individual_field_data.csv")
head(data1)
head(data2)
head(data1)
cor(data1$N.family.level, data1$avg.eye.width)
cor(data1$N.family.level, data1$avg.eye.width, use="complete")
head(data1)
?phylANOVA
pANOVA_Eye <- phylANOVA(treeb, data1$Species, data1$avg.eye.width)
treeb
unique(data1$Species)
setdiff(data1$Species, treeb$tip.label)
setdiff(treeb$tip.label, data1$Species)
Drops <- setdiff(treeb$tip.label, data1$Species)
treec <- drop.tip(treeb, Drops)
pANOVA_Eye <- phylANOVA(treec, data1$Species, data1$avg.eye.width)
data1$avg.eye.width
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
Eye
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
pANOVA_Eye <- phylANOVA(treec, names(Eye), Eye)
data1$Species=="Phyciodes_graphica"
data1[data1$Species=="Phyciodes_graphica",]
Drops <- setdiff(treeb$tip.label, data1$Species)
treec <- drop.tip(treeb, c(Drops, "Phyciodes_graphica"))
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
Eye <- Eye[-which(names(Eye) == "Phyciodes_graphica")]
pANOVA_Eye <- phylANOVA(treec, names(Eye), Eye)
Drops <- setdiff(treeb$tip.label, data1$Species)
treec <- drop.tip(treeb, c(Drops, "Phyciodes_graphica"))
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
Eye <- Eye[-which(names(Eye) == "Phyciodes_graphica")]
pANOVA_Eye <- phylANOVA(treec, names(Eye), Eye[treec$tip.label])
Nitro <- tapply(data1$N.family.level, data1$Species, mean, na.rm=T)
pANOVA_Nitro <- phylANOVA(treec, names(Nitro), Nitro[treec$tip.label])
Nitro[is.na(Nitro)]
tree_nitro <- drop.tip(treec, "Feniseca_tarquinius")
pANOVA_Nitro <- phylANOVA(tree_nitro, names(Nitro), Nitro[tree_nitro$tip.label])
Wing <- tapply(data1$Wing.Length, data1$Species, mean, na.rm=T)
Wing[is.na(Wing)]
Drops <- setdiff(treeb$tip.label, data1$Species)
treec <- drop.tip(treeb, Drops)
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
Eye <- Eye[-which(names(Eye) == "Phyciodes_graphica")]
tree_eye <- drop.tip(treec, "Phyciodes_graphica")
pANOVA_Eye <- phylANOVA(tree_eye, names(Eye), Eye[tree_eye$tip.label])
Nitro <- tapply(data1$N.family.level, data1$Species, mean, na.rm=T)
Nitro <- Nitro[-which(names(Nitro)=="Feniseca_tarquinius")]
tree_nitro <- drop.tip(treec, "Feniseca_tarquinius")
pANOVA_Nitro <- phylANOVA(tree_nitro, names(Nitro), Nitro[tree_nitro$tip.label])
Wing <- tapply(data1$Wing.Length, data1$Species, mean, na.rm=T)
pANOVA_Wing <- phylANOVA(treec, names(Wing), Wing[treec$tip.label])
warnngs()
warnings()
View(pANOVA_Eye)
View(pANOVA_Nitro)
View(pANOVA_Wing)
View(data1)
cor(data1$Species, data1$avg.eye.width, use="complete")
cor(data1$N.family.level, data1$avg.eye.width, use="complete")
cor(data1$N.family.level, data1$Wing.Length, use="complete")
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
Eye <- Eye[-which(names(Eye) == "Phyciodes_graphica")]
tree_eye <- drop.tip(treec, "Phyciodes_graphica")
pANOVA_Eye <- phylANOVA(tree_eye, names(Eye), Eye[tree_eye$tip.label])
RStudio.Version()
View(data2)
summary(treeb)
summary(treec)
plot(N.family.level, avg.eye.width)
plot(Nitro, Eye)
View(data1)
View(data1)
plot(x=Nitro, y=Eye, pch=16, frame=FALSE, xlab="Nitro", ylab="Eye", col="#2E9FDF", xlim=c(0,4), ylim=c(0,2), main='Nitrogen vs Eye Width')
Model <- lm(Nitro~Eye)
plot(Nitro, Eye)
plot(x=Nitro, y=Eye, pch=16, frame=FALSE, xlab="Nitro", ylab="Eye", col="#2E9FDF", xlim=c(0,4), ylim=c(0,2), main='Nitrogen vs Eye Width')
abline(Model)
abline(Model)
Model <- lm(Nitro~Eye)
View(Model)
plot(Nitro, Eye)
abline(Model)
Model <- lm(Eye~Nitro)
abline(Model)
#scatterplot for nitrogen and wing length
plot(Nitro, Wing)
length(Nitro)
length(Eye)
length(Wing)
plot(Nitro, Wing[1:length(Nitro)])
Model <- lm(Wing~Nitro)
Model <- lm(Wing~Nitro, drop.unused.levels = TRUE)
plot(x=Nitro, y=Eye, pch=16, frame=FALSE, xlab="Nitrogen", ylab="Eye Width", col="#2E9FDF", xlim=c(0,4), ylim=c(0,2), main='Nitrogen vs Eye Width')
plot(x=Nitro, y=Eye, xlab="Nitrogen", ylab="Eye Width", main='Nitrogen vs Eye Width')
Model <- lm(Eye~Nitro)
abline(Model)
Wing <- tapply(data1$Wing.Length, data1$Species, mean, na.rm=T)
Nitro <- tapply(data1$N.family.level, data1$Species, mean, na.rm=T)
plot(Nitro, Wing)
Model <- lm(Wing~Nitro)
abline(Model)
plot(x=Nitro, y=Wing, xlab="Nitrogen", ylab="Wing Length", main='Nitrogen vs Wing Length')
abline(Model)
Eye <- tapply(data1$avg.eye.width, data1$Species, mean, na.rm=T)
plot(Nitro, Eye)
plot(x=Nitro, y=Eye, xlab="Nitrogen", ylab="Eye Width", main='Nitrogen vs Eye Width')
Model <- lm(Eye~Nitro)
abline(Model)
pdf("Phylogenetic Tree")
summary(fit)
summary(Model)
plot(Nitro, Eye)
Model <- lm(Eye~Nitro)
abline(Model)
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared, digitd=3)))
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared, digits=3)))
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared)))
plot(x=Nitro, y=Eye, xlab="Nitrogen", ylab="Eye Width", main='Nitrogen vs Eye Width')
Model <- lm(Eye~Nitro)
abline(Model)
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared)))
pdf(Nitrogen vs Eye Width.pdf)
pdf(Nitrogen and Eye Width.pdf)
pdf("Nitrogen vs Eye Width.pdf")
plot(x=Nitro, y=Eye, xlab="Nitrogen", ylab="Eye Width", main='Nitrogen vs Eye Width')
Model <- lm(Eye~Nitro)
abline(Model)
summary(Model)
plot(x=Nitro, y=Wing, xlab="Nitrogen", ylab="Wing Length", main='Nitrogen vs Wing Length')
Model <- lm(Wing~Nitro)
abline(Model)
summary(Model)
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared)))
setwd("~/Desktop/Evolution/Tasks/Project2/Data")
data1 <- read.csv("individual_collection_data.csv")
data2 <- read.csv("individual_field_data.csv")
library(phytools)
treeb <- read.nexus("butterfly_tree.nex")
plot(treeb)
pdf("Phylogenetic Tree")
plot(treeb, cex=0.5)
plot(treeb)
plot(treeb, cex=0.2)
setwd("~/Desktop/Evolution/Tasks/Project2/Data")
data1 <- read.csv("individual_collection_data.csv")
data2 <- read.csv("individual_field_data.csv")
library(phytools)
treeb <- read.nexus("butterfly_tree.nex")
plot(treeb, cex=0.3)
setwd("~/Desktop/Evolution/Tasks/Project2/Data")
data1 <- read.csv("individual_collection_data.csv")
data2 <- read.csv("individual_field_data.csv")
library(phytools)
treeb <- read.nexus("butterfly_tree.nex")
plot(treeb, cex=0.2)
setwd("~/Desktop/Evolution/Tasks/Project2/Data")
data1 <- read.csv("individual_collection_data.csv")
data2 <- read.csv("individual_field_data.csv")
library(phytools)
treeb <- read.nexus("butterfly_tree.nex")
plot(treeb, cex=0.5)
setwd("~/Desktop/Evolution/Tasks/Project2/Data")
data1 <- read.csv("individual_collection_data.csv")
data2 <- read.csv("individual_field_data.csv")
library(phytools)
treeb <- read.nexus("butterfly_tree.nex")
plot(treeb, cex=0.4)
pdf("Phylogenetic Tree")
cor(data1$N.family.level, data1$avg.eye.width, use="complete")
cor(data1$N.family.level, data1$avg.eye.width, use="complete", method= "spearman")
cor(data1$N.family.level, data1$Wing.Length, use="complete")
cor(data1$N.family.level, data1$Wing.Length, use="complete", method="spearman")
cor(data1$N.family.level, data1$avg.eye.width, use="complete", method= "kendall")
cor(data1$N.family.level, data1$Wing.Length, use="complete", method="kendall")
cor.test(data1$N.family.level, data1$avg.eye.width, use="complete")
cor.test(data1$N.family.level, data1$Wing.Length, use="complete")
cor.test(data1$N.family.level, data1$avg.eye.width, use="complete", method= "spearman")
cor(data1$N.family.level, data1$avg.eye.width, use="complete", method= "spearman")
cor.test(data1$N.family.level, data1$avg.eye.width, use="complete", method= "kendall")
cor.test(data1$N.family.level, data1$Wing.Length, use="complete", method="kendall")
cor.test(data1$N.family.level, data1$Wing.Length, use="complete", method="spearman")
cor.test(data1$N.family.level, data1$avg.eye.width, use="complete", method= "spearman", exact= FALSE)
cor.test(data1$N.family.level, data1$Wing.Length, use="complete", method="spearman", exact= FALSE)
Model <- lm(Eye~Nitro)
plot(Nitro, Eye)
abline(Model)
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared)))
plot(x=Nitro, y=Eye, xlab="Nitrogen", ylab="Eye Width", main='Nitrogen vs Eye Width')
summary(Model)
legend("topleft", legend=paste("R2=", format(summary(Model)$r.squared)))
help(legend)
legend("topleft", legend=paste("R^2=", format(summary(Model)$r.squared)))
legend("topleft", legend=paste("pvalue=", format(summary(Model)$p.value)))
legend("topleft", legend=paste("pvalue=", format(summary(Model)$p-value)))
legend("topleft", legend=paste("pvalue=0.00844"))
legend("topleft", legend=paste("R^2=", format(summary(Model)$r.squared)), legend=paste("pvalue=0.00844"))
legend("topleft", legend=paste("R^2=", format(summary(Model)$r.squared)))
legend("topright", legend=paste("pvalue=0.00844"))
Model <- lm(Eye~Nitro)
plot(x=Nitro, y=Eye, xlab="Nitrogen", ylab="Eye Width", main='Nitrogen vs Eye Width')
abline(Model)
summary(Model)
plot(x=Nitro, y=Eye, xlab="Nitrogen Intake (%)", ylab="Eye Width", main='Nitrogen vs Eye Width')
plot(x=Nitro, y=Eye, xlab=" Percent Nitrogen Intake", ylab="Eye Width", main='Nitrogen vs Eye Width')
abline(Model)
Model <- lm(Wing~Nitro)
plot(x=Nitro, y=Wing, xlab=" Percent Nitrogen Intake", ylab="Wing Length", main='Nitrogen vs Wing Length')
abline(Model)
summary(Model)
Model <- lm(Eye~Nitro)
plot(x=Nitro, y=Eye, xlab=" Percent Nitrogen Intake", ylab="Eye Width", main='Nitrogen vs Eye Width')
abline(Model)
summary(Model)
